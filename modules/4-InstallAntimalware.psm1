function Install-Antimalware {
    $RootPath = "$(Split-Path $PSScriptRoot -Parent)\software"

    # Download MalwareBytes
    $MBPath = "$RootPath\MalwareBytes_Setup.exe"

    if (!(Test-Path -Path $MBPath)) {
        Write-Output "Downloading MalwareBytes..."
        Invoke-WebRequest -Uri "https://www.malwarebytes.com/api/downloads/mb-windows?filename=MBSetup.exe" -OutFile $MBPath
    }
    else {
        Write-Output "MalwareBytes is already downloaded"
    }

    # Download AdwCleaner
    $AdwCPath = "$RootPath\AdwCleaner_Setup.exe"

    if (!(Test-Path -Path $AdwCPath)) {
        Write-Output "Downloading AdwCleaner..."
        Invoke-WebRequest -Uri "https://adwcleaner.malwarebytes.com/adwcleaner?channel=release" -OutFile $AdwCPath
    }
    else {
        Write-Output "AdwCleaner is already downloaded"
    }

    Write-Output ""

    # Run MalwareBytes
    $MBExecPath = """C:\Program Files\Malwarebytes\Anti-Malware\mbam.exe"""
    $MBUninstPath = """C:\Program Files\Malwarebytes\Anti-Malware\uninst000.exe"""
    
    Write-Output "Starting MalwareBytes..."
    invoke-expression "cmd /c start powershell -Command { $MBPath /VERYSILENT /NORESTART }"
    # invoke-expression "cmd /c start powershell -Command { $MBPath /VERYSILENT /NORESTART; $MBExecPath; Write-Output `"Open MalwareBytes and complete malware scan, then continue below:`"; pause; $MBUninstPath /verysilent /suppressmsgboxes /norestart }"

    # Run AdwCleaner
    Write-Output "Starting AdwCleaner..."
    invoke-expression "cmd /c start powershell -Command { $AdwcPath /eula /clean /noreboot /preinstalled; $AdwcPath /eula /uninstall /noreboot }"
}