function Install-Antimalware {
    $RootPath = "$(Split-Path $PSScriptRoot -Parent)\software"

    # Download MalwareBytes
    $MBPath = "$RootPath\MalwareBytes_Setup.exe"

    if (!(Test-Path -Path $MBPath)) {
        Write-Output "Downloading MalwareBytes..."
        Invoke-WebRequest -Uri "https://www.malwarebytes.com/api/downloads/mb-windows?filename=MBSetup.exe" -OutFile $MBPath
    }
    else {
        Write-Output "MalwareBytes is already downloaded"
    }

    # Download AdwCleaner
    $AdwCPath = "$RootPath\AdwCleaner_Setup.exe"

    if (!(Test-Path -Path $AdwCPath)) {
        Write-Output "Downloading AdwCleaner..."
        Invoke-WebRequest -Uri "https://adwcleaner.malwarebytes.com/adwcleaner?channel=release" -OutFile $AdwCPath
    }
    else {
        Write-Output "AdwCleaner is already downloaded"
    }

    Write-Output ""

    # Run MalwareBytes
    Write-Output "Starting MalwareBytes..."
    Start-Process -NoNewWindow -FilePath $MBPath -ArgumentList "/VERYSILENT", "/NORESTART"

    # Run AdwCleaner
    Write-Output "Starting AdwCleaner..."
    Start-Process -NoNewWindow -FilePath $AdwcPath -ArgumentList "/eula", "/clean", "/noreboot", "/preinstalled"
}